# Вики-документация по проекту "TaskJunior"

Добро пожаловать в вики-документацию по проекту "TaskJunior". Этот документ предоставляет обзор проекта, его технического стека, структуры и основных модулей.

## 1. Обзор проекта

"TaskJunior" — это веб-приложение для управления задачами и проектами, реализованное в виде Канбан-досок. Оно позволяет пользователям:
- Регистрироваться и входить в систему.
- Создавать доски для организации проектов.
- Управлять задачами на досках: создавать, редактировать, назначать исполнителей, изменять статусы (В ожидании, В работе, Завершено) и приоритеты.
- Визуализировать задачи на диаграмме Ганта.
- Перемещать задачи между колонками статусов с помощью drag-and-drop.
- Получать уведомления о важных событиях в реальном времени.
- Добавлять пользователей в доски

## 2. Технологический стек

-   **Бэкенд**: PHP
-   **Фронтенд**: HTML, CSS, JavaScript (Vanilla JS)
-   **База данных**: MySQL
-   **Реал-тайм обновления**: Pusher

## 3. Структура проекта

Основные файлы и директории в проекте:

-   `/` (корень проекта):
    -   `index.php`: Главная страница.
    -   `login.php`: Страница входа.
    -   `register.php`: Страница регистрации.
    -   `dashboard.php`: Главная страница пользователя после входа, отображает доски.
    -   `tasks.php`: Страница отображения задач конкретной доски.
    -   `edit_board.php`: Страница для редактирования доски и управления ее участниками.
    -   `db.php`: Конфигурация подключения к базе данных.
    -   `schema.sql`: SQL-схема для создания таблиц базы данных.
-   `api/`: Содержит PHP скрипты, обрабатывающие AJAX-запросы от фронтенда.
    -   `auth.php`: Логика аутентификации (вход, регистрация).
    -   `boards.php`: API для управления досками (создание, получение, обновление, удаление, управление участниками).
    -   `tasks.php`: API для управления задачами (создание, получение, обновление статуса/деталей, назначение, удаление).
    -   `notifications.php`: API для получения и управления уведомлениями.
    -   `notifications_helper.php`: Вспомогательные функции для создания уведомлений.
    -   `pusher_config.php`: Конфигурация Pusher.
-   `css/`: Стили проекта.
    -   `style.css`: Основные стили.
    -   `theme.css`: Стили для темной/светлой темы.
    -   `landing-page.css`: Стили для главной страницы.
-   `js/`: JavaScript файлы для интерактивности на стороне клиента.
    -   `dashboard.js`: Логика для страницы `dashboard.php`.
    -   `tasks.js`: Логика для страницы `tasks.php`.
    -   `edit_board.js`: Логика для страницы `edit_board.php`.
    -   `notifications.js`: Логика для отображения уведомлений.
    -   `theme.js`: Логика для переключения тем.
-   `vendor/`: Зависимости PHP - Pusher.

## 4. Основные модули и их работа

### 4.1. Аутентификация
-   **Регистрация**: Пользователи могут зарегистрироваться через `register.php`. Данные отправляются на `api/auth.php?action=register`. Пароли хешируются. По умолчанию пользователю присваивается роль 'user'.
-   **Вход**: Пользователи входят через `login.php`. Данные проверяются в `api/auth.php?action=login`. Информация о пользователе сохраняется в сессии (`$_SESSION['user']`).

### 4.2. Доски (`dashboard.php`, `js/dashboard.js`, `api/boards.php`)
-   Пользователи видят список своих досок и досок, к которым им предоставлен доступ.
-   **Создание доски**: Через модальное окно на `dashboard.php`. Запрос идет на `api/boards.php?action=create`.
-   **Редактирование доски (`edit_board.php`, `js/edit_board.js`)**: Владелец доски может изменять название, описание и управлять участниками (добавлять/удалять пользователей на доску). Запросы на `api/boards.php`.
-   **Удаление доски**: Только владелец. Запрос на `api/boards.php?action=delete`.

### 4.3. Задачи (`tasks.php`, `js/tasks.js`, `api/tasks.php`)
-   **Отображение задач**: Задачи отображаются в колонках в соответствии с их статусом.
-   **Создание задачи**: Только владелец доски может создавать задачи. Форма на `tasks.php`, запрос на `api/tasks.php?action=create`.
-   **Редактирование задачи**: Владелец доски может редактировать все поля задачи. Назначенный исполнитель может редактировать статус задачи.
-   **Изменение статуса**: Перетаскиванием (drag-and-drop) или через выпадающий список. Запрос на `api/tasks.php?action=update_status`.
-   **Назначение исполнителя**: Владелец доски может назначить исполнителя из числа участников доски.
-   **Диаграмма Ганта**: Задачи с дедлайном отображаются на диаграмме Ганта (`frappe-gantt`).

### 4.4. Роли пользователей
-   -   **Роли на доске** (определяются динамически на основе владения и членства в `board_members`):
    -   `owner`: Владелец доски. Полные права на доску и ее задачи (создание, редактирование, удаление задач, управление участниками).
    -   `participant_developer`: Участник доски (разработчик). Может видеть назначенные ему задачи, изменять их статус. Не может создавать новые задачи.

### 4.5. Уведомления (`js/notifications.js`, `api/notifications.php`, `api/notifications_helper.php`)
-   Пользователи получают уведомления о событиях, таких как назначение задачи, обновление задачи и т.д.
-   Уведомления отображаются в выпадающем списке в шапке сайта.
-   Используется Pusher для доставки уведомлений в реальном времени.

## 5. API (Бэкенд)

Бэкенд реализован в виде PHP-скриптов в директории `api/`. Фронтенд взаимодействует с этими скриптами через AJAX-запросы (обычно `fetch`).
Основные эндпоинты:
-   `api/auth.php`: `action=login`, `action=register`
-   `api/boards.php`: `action=get`, `action=create`, `action=update`, `action=delete`, `action=get_members`, `action=add_member`, `action=remove_member`, `action=update_member_role`
-   `api/tasks.php`: `action=get`, `action=create`, `action=update_details`, `action=update_status`, `action=assign`, `action=delete`, `action=get_details`, `action=stats`
-   `api/notifications.php`: `action=get_unread`, `action=mark_as_read`, `action=mark_all_as_read`

Ответы от API обычно в формате JSON.
